(function(){"use strict";var t={701:function(t,e,i){var s=i(9242),n=i(3396);const r={class:"app"};function h(t,e){const i=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(i)])}var o=i(89);const a={},l=(0,o.Z)(a,[["render",h]]);var c=l,u=i(2483);const d=t=>((0,n.dD)("data-v-7879d6e8"),t=t(),(0,n.Cn)(),t),g=d((()=>(0,n._)("div",{class:"header"},[(0,n._)("header",{id:"header"},[(0,n._)("span",null,"Shornikov Sergei P3211 Variant ...")])],-1))),p={class:"auth-page"},w={key:0,class:"form-container"},C=d((()=>(0,n._)("button",{type:"submit"},"Login",-1))),m={key:0,class:"error-message"},x={key:1,class:"form-container"},v=d((()=>(0,n._)("button",{type:"submit"},"Register",-1))),f={key:0,class:"error-message"};function b(t,e,i,r,h,o){return(0,n.wg)(),(0,n.iD)(n.HY,null,[g,(0,n._)("div",p,[h.showLogin?((0,n.wg)(),(0,n.iD)("div",w,[(0,n._)("form",{onSubmit:e[2]||(e[2]=(0,s.iM)(((...t)=>o.login&&o.login(...t)),["prevent"]))},[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>h.username=t),placeholder:"Username",required:""},null,512),[[s.nr,h.username]]),(0,n.wy)((0,n._)("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=t=>h.password=t),placeholder:"Password",required:""},null,512),[[s.nr,h.password]]),C,h.loginError?((0,n.wg)(),(0,n.iD)("p",m,"Неправильный логин или пароль")):(0,n.kq)("",!0)],32),(0,n._)("p",{class:"toggle-form",onClick:e[3]||(e[3]=(...t)=>o.toggleForm&&o.toggleForm(...t))},"Нет аккаунта?")])):((0,n.wg)(),(0,n.iD)("div",x,[(0,n._)("form",{onSubmit:e[6]||(e[6]=(0,s.iM)(((...t)=>o.register&&o.register(...t)),["prevent"]))},[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=t=>h.newUsername=t),placeholder:"Username",required:""},null,512),[[s.nr,h.newUsername]]),(0,n.wy)((0,n._)("input",{type:"password","onUpdate:modelValue":e[5]||(e[5]=t=>h.newPassword=t),placeholder:"Password",required:""},null,512),[[s.nr,h.newPassword]]),v,h.registrationError?((0,n.wg)(),(0,n.iD)("p",f,"Такой пользователь уже существует")):(0,n.kq)("",!0)],32),(0,n._)("p",{class:"toggle-form",onClick:e[7]||(e[7]=(...t)=>o.toggleForm&&o.toggleForm(...t))},"Уже зарегистрированы?")]))])],64)}i(560);var T=i(2310),y=i.n(T),I={name:"AuthPage",data(){return{showLogin:!0,username:"",password:"",newUsername:"",newPassword:"",loginError:!1,registrationError:!1}},methods:{toggleForm(){this.showLogin=!this.showLogin,this.loginError=!1,this.registrationError=!1},login(){fetch("http://localhost:8080/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((t=>{if(!t.ok)throw console.log(t.status),new Error("Login failed");return t.text()})).then((t=>{sessionStorage.setItem("jwtToken",t),this.$router.push("/main")})).catch((t=>{console.log(t),this.loginError=!0}))},register(){fetch("http://localhost:8080/api/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.newUsername,password:this.newPassword})}).then((t=>{if(!t.ok)throw new Error("Registration failed");y()({close:!0,text:"Registration successful!. \nPlease sign in",duration:3e3,style:{color:"white",background:"linear-gradient(to right, #489149, #539680)"}}).showToast()})).catch((t=>{console.log(t),this.registrationError=!0}))}}};const k=(0,o.Z)(I,[["render",b],["__scopeId","data-v-7879d6e8"]]);var _=k;const R={class:"main"},D={class:"main-container"};function P(t,e,i,s,r,h){const o=(0,n.up)("HeaderComponent"),a=(0,n.up)("GraphCanvas"),l=(0,n.up)("InputFields"),c=(0,n.up)("ResultTable");return(0,n.wg)(),(0,n.iD)("div",R,[(0,n.Wm)(o),(0,n._)("div",D,[(0,n.Wm)(a,{ref:"graphCanvas",tableData:r.tableData,responseData:r.graphData,currentR:r.r,onClickOnCanvas:h.handleClick},null,8,["tableData","responseData","currentR","onClickOnCanvas"]),(0,n.Wm)(l,{onFormSubmitted:h.handleServerResponse,onRUpdated:h.handleRUpdate},null,8,["onFormSubmitted","onRUpdated"]),(0,n.Wm)(c,{history:r.tableData,onClearTable:h.clearTable},null,8,["history","onClearTable"])])])}const S=t=>((0,n.dD)("data-v-795d3264"),t=t(),(0,n.Cn)(),t),O={class:"header"},E=S((()=>(0,n._)("header",{id:"header"},[(0,n._)("span",null,"Shornikov Sergei P3211 Variant ...")],-1)));function F(t,e,i,s,r,h){return(0,n.wg)(),(0,n.iD)("div",O,[E,(0,n._)("button",{onClick:e[0]||(e[0]=(...t)=>h.logOut&&h.logOut(...t))},"Log out")])}var U={name:"HeaderComponent",methods:{logOut(){sessionStorage.clear(),this.$router.go(-1)}}};const j=(0,o.Z)(U,[["render",F],["__scopeId","data-v-795d3264"]]);var Y=j;const z={class:"div-canvas"};function M(t,e,i,s,r,h){return(0,n.wg)(),(0,n.iD)("div",z,[(0,n._)("canvas",{onClick:e[0]||(e[0]=(...t)=>h.clickOnCanvas&&h.clickOnCanvas(...t)),id:"canvas",width:"600",height:"500"})])}var N={name:"GraphCanvas",data(){return{userInputX:0,userInputY:0,userInputR:2,lastResult:"",canvas:null,ctx:null,widthCenter:0,heightCenter:0}},mounted(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.widthCenter=this.canvas.width/2,this.heightCenter=this.canvas.height/2,this.draw()},props:{responseData:{type:[Object],default:()=>{}},tableData:Array,currentR:null},watch:{currentR(t){this.userInputR=t,this.redrawAllPoints()},tableData(){this.redrawAllPoints()},responseData(t){this.userInputX=t.x,this.userInputY=t.y,this.userInputR=t.r,this.drawPoint(t.result)}},methods:{clearCanvas(){this.draw(),this.draw()},redrawAllPoints(){this.ctx.clearRect(0,0,1e3,1e3),this.draw();for(let t=0;t<this.tableData.length;t++){let e=null===this.userInputR?this.currentR:this.userInputR;this.drawPointWithCords(this.hit(this.tableData[t].x,this.tableData[t].y,Math.abs(e)),this.tableData[t].x,this.tableData[t].y,Math.abs(e))}},drawPointWithCords(t,e,i,s){"In"===t.trim()?this.ctx.fillStyle="green":this.ctx.fillStyle="red",this.ctx.beginPath(),this.ctx.arc(this.widthCenter+100*parseFloat(e)/parseFloat(s),this.heightCenter-100*parseFloat(i)/parseFloat(s),3,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill()},hit(t,e,i){return t>0&&e<0?this.hitTriangle(t,e,i):t<0&&e>0?this.hitCircle(t,e,i):t<0&&e<0?this.hitSquare(t,e,i):0===t&&e<=i&&e>=-i||0===e&&t<=i&&t>=-i?"In":"Out"},hitCircle(t,e,i){return t*t+e*e<=i*i/4?"In":"Out"},hitSquare(t,e,i){return t>=-i&&e>=-i?"In":"Out"},hitTriangle(t,e,i){return e>=t-i?"In":"Out"},sendToServer(t,e,i){const s={x:t,y:e,r:i},n=sessionStorage.getItem("jwtToken");fetch("http://localhost:8080/api/shots",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(s)}).then((t=>{if(console.log(t.status),201!==t.status)throw new Error("Network response was not ok");return t.json()})).then((t=>{this.$emit("clickOnCanvas",t),this.drawPoint(t.result)})).catch((t=>{console.error("Ошибка при отправке формы:",t)}))},clickOnCanvas(){if(this.userInputR<1)return void y()({text:"Значение R невлидно! \n R > 0!",duration:3e3}).showToast();let t=this.userInputR;const e=this.canvas.getBoundingClientRect(),i=event.clientX-e.left,s=event.clientY-e.top,n=(i-this.widthCenter)*t/100,r=(this.heightCenter-s)*t/100;this.userInputX=n,this.userInputY=r,this.sendToServer(this.userInputX,this.userInputY,t)},drawPoint(t){Math.abs(this.userInputY)>this.userInputR||Math.abs(this.userInputX)>this.userInputR?y()({text:"Выход за граница графика!",duration:3e3}).showToast():("In"===t.trim()?this.ctx.fillStyle="green":this.ctx.fillStyle="red",this.ctx.beginPath(),this.ctx.arc(this.widthCenter+100*this.userInputX/this.userInputR,this.heightCenter-100*parseFloat(this.userInputY)/this.userInputR,3,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill())},draw(){this.ctx.clearRect(0,0,1e3,1e3),this.ctx.beginPath(),this.ctx.fillStyle="rgba(249,192,116,256)",this.ctx.fillRect(this.widthCenter,this.heightCenter,-100,100),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.arc(this.widthCenter,this.heightCenter,50,Math.PI,-Math.PI/2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.lineTo(this.widthCenter,this.heightCenter+100),this.ctx.lineTo(this.widthCenter+100,this.heightCenter),this.ctx.fill(),this.ctx.fillStyle="black",this.ctx.beginPath(),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.lineTo(this.widthCenter+125,this.heightCenter),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.lineTo(this.widthCenter-125,this.heightCenter),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.lineTo(this.widthCenter,this.heightCenter+125),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.lineTo(this.widthCenter,this.heightCenter-125),this.ctx.moveTo(this.widthCenter,this.heightCenter-125),this.ctx.lineTo(this.widthCenter-5,this.heightCenter-120),this.ctx.moveTo(this.widthCenter,this.heightCenter-125),this.ctx.lineTo(this.widthCenter+5,this.heightCenter-120),this.ctx.fillText("Y",this.widthCenter,this.heightCenter-125),this.ctx.moveTo(this.widthCenter+125,this.heightCenter),this.ctx.lineTo(this.widthCenter+120,this.heightCenter-5),this.ctx.moveTo(this.widthCenter+125,this.heightCenter),this.ctx.lineTo(this.widthCenter+120,this.heightCenter+5),this.ctx.moveTo(this.widthCenter+50,this.heightCenter-5),this.ctx.lineTo(this.widthCenter+50,this.heightCenter+5),this.ctx.fillText(-1*this.userInputR/2,this.widthCenter+50,this.heightCenter-8),this.ctx.moveTo(this.widthCenter+100,this.heightCenter-5),this.ctx.lineTo(this.widthCenter+100,this.heightCenter+5),this.ctx.fillText(-1*this.userInputR,this.widthCenter+100,this.heightCenter-8),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.moveTo(this.widthCenter-50,this.heightCenter-5),this.ctx.lineTo(this.widthCenter-50,this.heightCenter+5),this.ctx.fillText(-1*this.userInputR/2,this.widthCenter-50,this.heightCenter-8),this.ctx.moveTo(this.widthCenter-100,this.heightCenter-5),this.ctx.lineTo(this.widthCenter-100,this.heightCenter+5),this.ctx.fillText(-1*this.userInputR,this.widthCenter-100,this.heightCenter-8),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.moveTo(this.widthCenter-5,this.heightCenter-50),this.ctx.lineTo(this.widthCenter+5,this.heightCenter-50),this.ctx.fillText(this.userInputR/2,this.widthCenter+10,this.heightCenter-45),this.ctx.moveTo(this.widthCenter-5,this.heightCenter-100),this.ctx.lineTo(this.widthCenter+5,this.heightCenter-100),this.ctx.fillText(this.userInputR,this.widthCenter+10,this.heightCenter-95),this.ctx.moveTo(this.widthCenter,this.heightCenter),this.ctx.moveTo(this.widthCenter-5,this.heightCenter+50),this.ctx.lineTo(this.widthCenter+5,this.heightCenter+50),this.ctx.fillText(-1*this.userInputR/2,this.widthCenter+10,this.heightCenter+55),this.ctx.moveTo(this.widthCenter-5,this.heightCenter+100),this.ctx.lineTo(this.widthCenter+5,this.heightCenter+100),this.ctx.fillText(-1*this.userInputR,this.widthCenter+10,this.heightCenter+105),this.ctx.strokeStyle="black",this.ctx.stroke(),this.ctx.closePath()}}};const $=(0,o.Z)(N,[["render",M],["__scopeId","data-v-a6d9b01e"]]);var A=$,X=i(7139);const q={class:"sendForm"},L={id:"choose-x"},H=["onClick"],V={id:"choose-y"},W={id:"choose-r"},Z=["onClick"];function B(t,e,i,r,h,o){return(0,n.wg)(),(0,n.iD)("div",q,[(0,n._)("form",{onSubmit:e[2]||(e[2]=(0,s.iM)((()=>{}),["prevent"]))},[(0,n._)("div",L,[(0,n.Uk)(" X: "+(0,X.zw)(h.x)+" ",1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.xNumbers,(t=>((0,n.wg)(),(0,n.iD)("button",{key:"x-"+t,class:(0,X.C_)({selected:t===h.x}),onClick:e=>h.x=t},(0,X.zw)(t),11,H)))),128))]),(0,n._)("div",V,[(0,n.Uk)(" Y: "+(0,X.zw)(h.y)+" ",1),(0,n.wy)((0,n._)("input",{placeholder:"-3...3",maxlength:"6",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>h.y=t)},null,512),[[s.nr,h.y]])]),(0,n._)("div",W,[(0,n.Uk)(" R: "+(0,X.zw)(h.r)+" ",1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.rNumbers,(t=>((0,n.wg)(),(0,n.iD)("button",{type:"submit",key:"r-"+t,class:(0,X.C_)({selected:t===h.r}),onClick:e=>h.r=t},(0,X.zw)(t),11,Z)))),128))]),(0,n._)("button",{onClick:e[1]||(e[1]=(...t)=>o.submitForm&&o.submitForm(...t))},"Отправить данные")],32)])}var G={name:"InputFields",data(){return{x:null,y:"",r:2,xNumbers:[-5,-4,-3,-2,-1,0,1,2,3],rNumbers:[-5,-4,-3,-2,-1,0,1,2,3]}},methods:{submitForm(){if(null===this.x||""===this.x)return void y()({text:"Значение x не введено!",duration:3e3}).showToast();if(isNaN(this.y)||this.y>3||this.y<-3||null===this.y||""===this.y)return void y()({text:"Значение Y некорректно! \n Y[-3...3]! ",duration:3e3}).showToast();if(null===this.r||this.r<1)return void y()({text:"Значение R некорректно! \nR > 0! ",duration:3e3}).showToast();const t=sessionStorage.getItem("jwtToken"),e={x:this.x,y:parseFloat(this.y),r:this.r};fetch("http://localhost:8080/api/shots",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}).then((t=>{if(console.log(t.status),201===t.status)return t.json();throw 401===t.status?(alert("Вы не авторизированы"),new Error("Unauthorized")):new Error("Unexpected error")})).then((t=>{console.log("принятные данные: ",t),this.$emit("formSubmitted",t)})).catch((t=>{console.error("Ошибка при отправке формы:",t)}))}},watch:{r(t){this.$emit("r-updated",t)}}};const J=(0,o.Z)(G,[["render",B],["__scopeId","data-v-33c7e3c0"]]);var K=J;const Q=t=>((0,n.dD)("data-v-0f0bc00f"),t=t(),(0,n.Cn)(),t),tt={class:"table-container"},et={class:"table",id:"result-table"},it=Q((()=>(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",null,"X"),(0,n._)("th",null,"Y"),(0,n._)("th",null,"R"),(0,n._)("th",null,"Result")])],-1)));function st(t,e,i,s,r,h){return(0,n.wg)(),(0,n.iD)("div",tt,[(0,n._)("button",{id:"clear-button",onClick:e[0]||(e[0]=(...t)=>h.clearTable&&h.clearTable(...t))}," Clear table "),(0,n._)("table",et,[it,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.history,(t=>((0,n.wg)(),(0,n.iD)("tr",{key:t.id},[(0,n._)("td",null,(0,X.zw)(t.x),1),(0,n._)("td",null,(0,X.zw)(t.y),1),(0,n._)("td",null,(0,X.zw)(t.r),1),(0,n._)("td",null,(0,X.zw)(t.result),1)])))),128))])])])}var nt={name:"ResultTable",props:{history:Array},methods:{clearTable(){const t=sessionStorage.getItem("jwtToken");fetch("http://localhost:8080/api/shots",{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}).then((t=>{if(console.log(t.status),204!==t.status)throw new Error("Network response was not ok");this.$emit("clearTable")})).catch((t=>{console.error("Ошибка при отправке формы:",t)}))}}};const rt=(0,o.Z)(nt,[["render",st],["__scopeId","data-v-0f0bc00f"]]);var ht=rt,ot={name:"MainPage",mounted(){this.fetchUserData()},data(){return{tableData:[],graphData:null,r:null}},components:{ResultTable:ht,InputFields:K,GraphCanvas:A,HeaderComponent:Y},methods:{fetchUserData(){const t=sessionStorage.getItem("jwtToken");console.log(t),t?fetch("http://localhost:8080/api/shots",{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}).then((t=>{if(console.log(t.status),!t.ok)throw new Error("Failed to fetch user data");return t.json()})).then((t=>{this.tableData=t})).catch((t=>console.error("Error fetching user data:",t))):console.log("logOut")},handleClick(t){this.tableData.push(t)},handleServerResponse(t){this.graphData=t,this.tableData.push(t)},handleRUpdate(t){this.r=t},clearTable(){this.tableData=[],this.$refs.graphCanvas.clearCanvas()}}};const at=(0,o.Z)(ot,[["render",P]]);var lt=at;const ct=(0,u.p7)({history:(0,u.PO)(),routes:[{path:"/",name:"auth",component:_},{path:"/main",name:"main",component:lt}]});ct.beforeEach(((t,e,i)=>{const s=["/"],n=!s.includes(t.path),r=sessionStorage.getItem("jwtToken");if(n&&!r)return i("/");i()}));var ut=ct;(0,s.ri)(c).use(ut).mount("#app")}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,i),r.exports}i.m=t,function(){var t=[];i.O=function(e,s,n,r){if(!s){var h=1/0;for(c=0;c<t.length;c++){s=t[c][0],n=t[c][1],r=t[c][2];for(var o=!0,a=0;a<s.length;a++)(!1&r||h>=r)&&Object.keys(i.O).every((function(t){return i.O[t](s[a])}))?s.splice(a--,1):(o=!1,r<h&&(h=r));if(o){t.splice(c--,1);var l=n();void 0!==l&&(e=l)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[s,n,r]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,s){var n,r,h=s[0],o=s[1],a=s[2],l=0;if(h.some((function(e){return 0!==t[e]}))){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(a)var c=a(i)}for(e&&e(s);l<h.length;l++)r=h[l],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(c)},s=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(701)}));s=i.O(s)})();
//# sourceMappingURL=app.e6ba595f.js.map